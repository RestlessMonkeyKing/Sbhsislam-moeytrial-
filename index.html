<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SBHS Islam | Modern Islamic Support</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&family=Noto+Naskh+Arabic:wght@400;600&display=swap" rel="stylesheet">
    <style>
        /* SBHS Theme Colors */
        :root {
            --sbhs-blue: #003366;
            --sbhs-gold: #FFCC00;
            --sbhs-light-blue: #336699;
            --light-color: #f8f9fa;
            --dark-color: #001a33;
            --transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            --page-bg: linear-gradient(135deg, var(--dark-color) 0%, var(--sbhs-blue) 100%);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: var(--page-bg);
            color: var(--light-color);
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
            background-attachment: fixed;
            transition: background 0.5s ease;
        }
        
        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Header Styles */
        header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            padding: 20px 0;
            z-index: 1000;
            transition: var(--transition);
            backdrop-filter: blur(10px);
            background: rgba(0, 26, 51, 0.9);
            border-bottom: 2px solid var(--sbhs-gold);
        }
        
        header.scrolled {
            padding: 15px 0;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
        }
        
        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .logo-icon {
            font-size: 28px;
            color: var(--sbhs-gold);
        }
        
        .logo h1 {
            font-family: 'Playfair Display', serif;
            font-weight: 700;
            font-size: 28px;
            background: linear-gradient(to right, var(--light-color), var(--sbhs-gold));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        nav ul {
            display: flex;
            list-style: none;
            gap: 30px;
        }
        
        nav a {
            color: var(--light-color);
            text-decoration: none;
            font-weight: 500;
            position: relative;
            padding: 5px 0;
            transition: var(--transition);
        }
        
        nav a:after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--sbhs-gold);
            transition: var(--transition);
        }
        
        nav a:hover {
            color: var(--sbhs-gold);
        }
        
        nav a:hover:after {
            width: 100%;
        }
        
        /* Hero Section */
        .hero {
            height: 100vh;
            display: flex;
            align-items: center;
            position: relative;
            overflow: hidden;
            padding-top: 80px;
        }
        
        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiPjxkZWZzPjxwYXR0ZXJuIGlkPSJwYXR0ZXJuIiB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHBhdHRlcm5Vbml0cz0idXNlclNwYWNlT25Vc2UiIHBhdHRlcm5UcmFuc2Zvcm09InJvdGF0ZSg0NSkiPjxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIxMCIgaGVpZ2h0PSIxMCIgZmlsbD0iIzMzNjY5OSIgZmlsbC1vcGFjaXR5PSIwLjEiLz48L3BhdHRlcm4+PC9kZWZzPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9InVybCgjcGF0dGVybikiLz48L3N2Zz4=');
            opacity: 0.3;
            z-index: -1;
        }
        
        .hero-content {
            max-width: 600px;
            animation: fadeInUp 1s ease-out;
        }
        
        .hero h2 {
            font-size: 3.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            font-family: 'Playfair Display', serif;
            line-height: 1.2;
        }
        
        .hero h2 span {
            color: var(--sbhs-gold);
        }
        
        .hero p {
            font-size: 1.2rem;
            margin-bottom: 30px;
            opacity: 0.9;
        }
        
        .cta-button {
            display: inline-block;
            background: linear-gradient(135deg, var(--sbhs-blue), var(--sbhs-light-blue));
            color: white;
            padding: 15px 35px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            transition: var(--transition);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
            border: none;
            cursor: pointer;
            font-size: 1rem;
            position: relative;
            overflow: hidden;
        }
        
        .cta-button:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 25px rgba(0, 0, 0, 0.3);
            background: linear-gradient(135deg, var(--sbhs-light-blue), var(--sbhs-blue));
        }
        
        .cta-button span {
            position: relative;
            z-index: 2;
        }
        
        .school-badge {
            position: absolute;
            right: 10%;
            top: 50%;
            transform: translateY(-50%);
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, rgba(255,204,0,0.1) 0%, rgba(255,204,0,0) 70%);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            animation: float 6s ease-in-out infinite;
        }
        
        .badge-inner {
            width: 200px;
            height: 200px;
            background: rgba(0, 51, 102, 0.7);
            border-radius: 50%;
            border: 3px solid var(--sbhs-gold);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 6rem;
            color: var(--sbhs-gold);
        }
        
        /* Features Section */
        .features {
            padding: 100px 0;
        }
        
        .section-title {
            text-align: center;
            margin-bottom: 60px;
        }
        
        .section-title h2 {
            font-size: 2.5rem;
            font-weight: 700;
            font-family: 'Playfair Display', serif;
            position: relative;
            display: inline-block;
            padding-bottom: 15px;
        }
        
        .section-title h2:after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background: var(--sbhs-gold);
            border-radius: 2px;
        }
        
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
        }
        
        .feature-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            overflow: hidden;
            transition: var(--transition);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 204, 0, 0.1);
            transform: translateY(20px);
            opacity: 0;
            animation: fadeInUp 0.8s forwards;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        .feature-card:nth-child(2) {
            animation-delay: 0.2s;
        }
        
        .feature-card:nth-child(3) {
            animation-delay: 0.4s;
        }
        
        .feature-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            border-color: rgba(255, 204, 0, 0.3);
        }
        
        .card-header {
            padding: 25px;
            background: rgba(0, 51, 102, 0.2);
            display: flex;
            align-items: center;
            gap: 15px;
            border-bottom: 1px solid rgba(255, 204, 0, 0.1);
        }
        
        .card-icon {
            width: 60px;
            height: 60px;
            background: var(--sbhs-blue);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: var(--sbhs-gold);
        }
        
        .card-header h3 {
            font-size: 1.5rem;
            font-weight: 600;
        }
        
        .card-content {
            padding: 25px;
        }
        
        .card-content p {
            margin-bottom: 20px;
            opacity: 0.8;
        }
        
        .card-button {
            display: inline-block;
            color: var(--sbhs-gold);
            text-decoration: none;
            font-weight: 600;
            transition: var(--transition);
            position: relative;
        }
        
        .card-button:after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--sbhs-gold);
            transition: var(--transition);
        }
        
        .card-button:hover:after {
            width: 100%;
        }
        
        /* Quran Section */
        .quran-sample {
            background: rgba(0, 0, 0, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }
        
        .quran-sample .arabic {
            font-size: 2.2rem;
            line-height: 1.8;
            margin: 15px 0;
            font-family: 'Noto Naskh Arabic', 'Traditional Arabic', serif;
            color: #e6d8a9;
        }
        
        .quran-sample .translation {
            font-style: italic;
            margin: 15px 0;
            color: #cccccc;
        }
        
        /* Audio Player */
        .audio-player {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .player-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .reciter-select {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid var(--sbhs-gold);
            padding: 8px 15px;
            border-radius: 30px;
            width: 100%;
            max-width: 200px;
        }
        
        .player-controls {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .play-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--sbhs-blue);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--sbhs-gold);
            font-size: 18px;
            cursor: pointer;
            transition: var(--transition);
            border: 2px solid var(--sbhs-gold);
        }
        
        .play-btn:hover {
            transform: scale(1.1);
            background: var(--sbhs-light-blue);
        }
        
        .progress-container {
            flex: 1;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            position: relative;
            cursor: pointer;
        }
        
        .progress-bar {
            height: 100%;
            width: 30%;
            background: var(--sbhs-gold);
            border-radius: 3px;
            position: relative;
        }
        
        .progress-bar:after {
            content: '';
            position: absolute;
            right: -5px;
            top: 50%;
            transform: translateY(-50%);
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--light-color);
            box-shadow: 0 0 5px rgba(255, 204, 0, 0.8);
        }
        
        /* Advice Section */
        .advice-container {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            margin-top: 20px;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255, 204, 0, 0.1);
        }
        
        .advice-container:before {
            content: '\f10e';
            font-family: 'Font Awesome 5 Free';
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 60px;
            opacity: 0.05;
            color: var(--sbhs-gold);
        }
        
        .advice-text {
            font-size: 1.4rem;
            font-style: italic;
            margin-bottom: 30px;
            position: relative;
            z-index: 2;
            line-height: 1.8;
            min-height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .advice-author {
            font-size: 1.1rem;
            font-weight: 500;
            color: var(--sbhs-gold);
        }
        
        /* Footer */
        footer {
            background: rgba(0, 0, 0, 0.3);
            padding: 50px 0 20px;
            margin-top: 100px;
            border-top: 1px solid var(--sbhs-gold);
        }
        
        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .footer-column h3 {
            font-size: 1.3rem;
            margin-bottom: 20px;
            position: relative;
            padding-bottom: 10px;
        }
        
        .footer-column h3:after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 40px;
            height: 3px;
            background: var(--sbhs-gold);
        }
        
        .footer-column p {
            opacity: 0.7;
            margin-bottom: 20px;
        }
        
        .social-links {
            display: flex;
            gap: 15px;
        }
        
        .social-links a {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.05);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--light-color);
            transition: var(--transition);
            border: 1px solid rgba(255, 204, 0, 0.2);
        }
        
        .social-links a:hover {
            background: var(--sbhs-blue);
            transform: translateY(-5px);
            border-color: var(--sbhs-gold);
        }
        
        .footer-links {
            list-style: none;
        }
        
        .footer-links li {
            margin-bottom: 10px;
        }
        
        .footer-links a {
            color: var(--light-color);
            text-decoration: none;
            transition: var(--transition);
            opacity: 0.8;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .footer-links i {
            color: var(--sbhs-gold);
        }
        
        .footer-links a:hover {
            opacity: 1;
            color: var(--sbhs-gold);
            padding-left: 5px;
        }
        
        .copyright {
            text-align: center;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.05);
            opacity: 0.7;
        }
        
        /* Animations */
        @keyframes fadeInUp {
            from {
                transform: translateY(20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        @keyframes float {
            0% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-15px);
            }
            100% {
                transform: translateY(0);
            }
        }
        
        .floating {
            animation: float 4s ease-in-out infinite;
        }
        
        /* Quran Audio Page */
        .quran-audio-page {
            display: none;
            padding: 100px 0 50px;
        }
        
        /* Quran Book Page */
        .quran-book-page {
            display: none;
            padding: 100px 0 50px;
        }
        
        .back-button {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: var(--sbhs-gold);
            text-decoration: none;
            margin-bottom: 20px;
            font-weight: 500;
        }
        
        .quran-player {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            overflow: hidden;
            transition: var(--transition);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 204, 0, 0.1);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            margin-bottom: 30px;
        }
        
        .quran-player-header {
            padding: 20px;
            background: rgba(0, 51, 102, 0.2);
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .quran-player-header h2 {
            font-size: 1.8rem;
            font-weight: 600;
        }
        
        .quran-player-controls {
            padding: 20px;
        }
        
        .quran-player-row {
            display: flex;
            gap: 15px;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .quran-player-label {
            font-size: 14px;
            color: var(--sbhs-gold);
            min-width: 80px;
        }
        
        .quran-player-select, .quran-player-input {
            background: rgba(0, 0, 0, 0.2);
            color: white;
            border: 1px solid var(--sbhs-gold);
            padding: 10px 15px;
            border-radius: 12px;
            outline: none;
            flex: 1;
            min-width: 200px;
        }
        
        .quran-player-button {
            background: linear-gradient(135deg, var(--sbhs-blue), var(--sbhs-light-blue));
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 500;
            transition: var(--transition);
        }
        
        .quran-player-button:hover {
            background: linear-gradient(135deg, var(--sbhs-light-blue), var(--sbhs-blue));
            transform: translateY(-2px);
        }
        
        .quran-player-audio {
            width: 100%;
            margin-top: 20px;
        }
        
        .quran-player-ayahs {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .quran-player-ayah {
            padding: 15px;
            border-bottom: 1px dashed rgba(255, 204, 0, 0.2);
            transition: background 0.3s ease;
        }
        
        .quran-player-ayah:hover {
            background: rgba(0, 51, 102, 0.2);
        }
        
        .quran-player-ayah.active {
            background: rgba(0, 51, 102, 0.3);
            border-left: 3px solid var(--sbhs-gold);
        }
        
        .quran-player-arabic {
            font-family: 'Noto Naskh Arabic', serif;
            font-size: 1.8rem;
            line-height: 2.1;
            direction: rtl;
            text-align: right;
            color: #e6d8a9;
            margin-bottom: 10px;
        }
        
        .quran-player-english {
            font-size: 1rem;
            color: #d6ddff;
        }
        
        /* 3D Quran Book Styles */
        .quran-book-page .panel {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 14px;
            padding: 12px;
            border: 1px solid rgba(255, 204, 0, 0.1);
        }
        
        .quran-book-page h1 {
            font-size: 18px;
            margin: 4px 0;
            color: #dfe8ff;
        }
        
        .quran-book-page label {
            font-size: 13px;
            color: #9fb0ff;
        }
        
        .quran-book-page select, 
        .quran-book-page button {
            width: 100%;
            padding: 10px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.04);
            background: rgba(0, 51, 102, 0.3);
            color: var(--light-color);
            outline: none;
        }
        
        .quran-book-page .row {
            display: flex;
            gap: 8px;
        }
        
        .quran-book-page .controls {
            display: grid;
            gap: 10px;
        }
        
        .quran-book-page .pill {
            display: inline-block;
            padding: 6px 10px;
            border-radius: 999px;
            background: rgba(255, 255, 255, 0.03);
            font-size: 13px;
        }
        
        /* Book area */
        #stage {
            min-height: 540px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .book-wrap {
            width: min(92vw, 920px);
            height: min(64vh, 640px);
            position: relative;
            perspective: 1800px;
        }
        
        .book {
            position: absolute;
            inset: 0;
            transform-style: preserve-3d;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 28px;
            align-items: center;
            justify-items: center;
        }
        
        .page {
            position: relative;
            width: 100%;
            height: 92%;
            background: #0f1a30;
            border-radius: 14px;
            padding: 34px 36px;
            box-shadow: 0 30px 60px rgba(2, 8, 23, 0.6);
            overflow: hidden;
        }
        
        .page .hdr {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            color: #9fb0ff;
        }
        
        .page .arab {
            font-family: 'Noto Naskh Arabic', serif;
            font-size: 34px;
            line-height: 2;
            direction: rtl;
            text-align: right;
            color: #e6d8a9;
        }
        
        .page .eng {
            font-size: 16px;
            color: #d6ddff;
            margin-top: 8px;
        }
        
        .page.empty {
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6b7aa7;
            font-size: 18px;
        }
        
        /* Simple page-curl effect using pseudo element + transform + mask */
        .page::after {
            content: '';
            position: absolute;
            right: 0;
            top: 0;
            width: 24%;
            height: 100%;
            pointer-events: none;
            mix-blend-mode: multiply;
            background: linear-gradient(90deg, rgba(0,0,0,0), rgba(0,0,0,0.06));
            border-radius: 0 14px 14px 0;
        }
        
        /* flip element used for animated curling */
        .flip-curl {
            position: absolute;
            left: 50%;
            top: 50%;
            width: 50%;
            height: 94%;
            transform-origin: left center;
            pointer-events: none;
            z-index: 50;
        }
        
        .flip-curl .inner {
            width: 100%;
            height: 100%;
            background: #0f1a30;
            border-radius: 14px 0 0 14px;
            box-shadow: 0 30px 60px rgba(2, 8, 23, 0.6);
            overflow: hidden;
        }
        
        .flip-curl .curl-shadow {
            position: absolute;
            right: 0;
            top: 0;
            height: 100%;
            width: 60px;
            background: linear-gradient(90deg, rgba(0,0,0,0.45), rgba(0,0,0,0));
            mix-blend-mode: multiply;
        }
        
        .controls-row {
            display: flex;
            gap: 8px;
        }
        
        .muted {
            color: #9fb0ff;
        }
        
        .footer {
            margin-top: 12px;
            color: #9fb0ff;
            font-size: 13px;
        }
        
        /* Responsive */
        @media (max-width: 992px) {
            .school-badge {
                display: none;
            }
            
            .hero-content {
                text-align: center;
                margin: 0 auto;
            }
            
            .hero h2 {
                font-size: 2.8rem;
            }
        }
        
        @media (max-width: 768px) {
            .hero h2 {
                font-size: 2.3rem;
            }
            
            nav ul {
                gap: 15px;
            }
            
            .feature-card {
                margin-bottom: 30px;
            }
            
            .book-wrap {
                height: min(50vh, 500px);
            }
        }
        
        @media (max-width: 576px) {
            .header-container {
                flex-direction: column;
                gap: 15px;
            }
            
            .hero h2 {
                font-size: 2rem;
            }
            
            .section-title h2 {
                font-size: 2rem;
            }
            
            .card-header {
                flex-direction: column;
                text-align: center;
            }
            
            .quran-player-row {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .book {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .page {
                height: 45%;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container header-container">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-mosque"></i>
                </div>
                <h1>SBHS Islam</h1>
            </div>
            <nav>
                <ul>
                    <li><a href="#" class="nav-home"><i class="fas fa-home"></i> Home</a></li>
                    <li><a href="#" class="nav-quran"><i class="fas fa-book-quran"></i> Quran</a></li>
                    <li><a href="#" class="nav-audio"><i class="fas fa-volume-up"></i> Audio</a></li>
                    <li><a href="#" class="nav-advice"><i class="fas fa-lightbulb"></i> Advice</a></li>
                    <li><a href="#" class="nav-about"><i class="fas fa-info-circle"></i> About</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Hero Section -->
        <section class="hero">
            <div class="container">
                <div class="hero-content">
                    <h2>Seek Knowledge, <span>Find Peace</span></h2>
                    <p>SBHS Islamic Society provides a modern platform for Quranic study, audio recitations, and daily Islamic guidance for Sydney Boys High School students.</p>
                    <a href="#" class="cta-button"><span>Begin Your Journey</span></a>
                </div>
                <div class="school-badge">
                    <div class="badge-inner">
                        <i class="fas fa-school"></i>
                    </div>
                </div>
            </div>
        </section>

        <!-- Features Section -->
        <section class="features">
            <div class="container">
                <div class="section-title">
                    <h2>Our Resources</h2>
                </div>
                <div class="features-grid">
                    <!-- Quran Reading -->
                    <div class="feature-card">
                        <div class="card-header">
                            <div class="card-icon">
                                <i class="fas fa-book-quran floating"></i>
                            </div>
                            <h3>Quran Reading</h3>
                        </div>
                        <div class="card-content">
                            <p>Explore the Holy Quran with our beautifully designed digital reader. Experience the divine words with ease and clarity.</p>
                            <div class="quran-sample">
                                <h4>Surah Al-Fatihah - The Opening</h4>
                                <p class="arabic">بِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ</p>
                                <p class="translation">"In the name of Allah, the Most Gracious, the Most Merciful."</p>
                                <p class="arabic">الْحَمْدُ لِلَّهِ رَبِّ الْعَالَمِينَ</p>
                                <p class="translation">"All praise is due to Allah, Lord of all the worlds."</p>
                            </div>
                            <a href="#" class="card-button nav-quran">Continue Reading <i class="fas fa-arrow-right"></i></a>
                        </div>
                    </div>
                    
                    <!-- Audio Quran -->
                    <div class="feature-card">
                        <div class="card-header">
                            <div class="card-icon">
                                <i class="fas fa-headphones floating"></i>
                            </div>
                            <h3>Audio Quran</h3>
                        </div>
                        <div class="card-content">
                            <p>Listen to the melodious recitation of the Holy Quran by renowned Qaris. Perfect for meditation and memorization.</p>
                            <div class="audio-player">
                                <div class="player-header">
                                    <h4>Surah Al-Fatihah</h4>
                                    <select class="reciter-select" id="reciter-select">
                                        <option value="mishari">Mishari Rashid Alafasy</option>
                                        <option value="abdulbasit">Abdul Basit Abdul Samad</option>
                                        <option value="maher">Maher Al Muaiqly</option>
                                        <option value="hudhaify">Ali Al Hudhaify</option>
                                        <option value="shatri">Saad Al Ghamdi</option>
                                    </select>
                                </div>
                                <div class="player-controls">
                                    <div class="play-btn" id="play-btn">
                                        <i class="fas fa-play" id="play-icon"></i>
                                    </div>
                                    <div class="progress-container">
                                        <div class="progress-bar" id="progress-bar"></div>
                                    </div>
                                </div>
                                <p style="margin-top: 10px; opacity: 0.7; font-size: 0.9rem;" id="current-reciter">Reciter: Mishari Rashid Alafasy</p>
                            </div>
                            <a href="#" class="card-button nav-audio">More Recitations <i class="fas fa-arrow-right"></i></a>
                        </div>
                    </div>
                    
                    <!-- Islamic Advice -->
                    <div class="feature-card">
                        <div class="card-header">
                            <div class="card-icon">
                                <i class="fas fa-lightbulb floating"></i>
                            </div>
                            <h3>Islamic Advice</h3>
                        </div>
                        <div class="card-content">
                            <p>Daily guidance and wisdom from Islamic scholars to help you navigate life with faith and integrity.</p>
                            <div class="advice-container">
                                <p class="advice-text" id="advice-text">"The best among you are those who have the best manners and character."</p>
                                <p class="advice-author" id="advice-author">- Prophet Muhammad (PBUH)</p>
                            </div>
                            <a href="#" class="card-button">More Wisdom <i class="fas fa-arrow-right"></i></a>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- SBHS Islamic Society Section -->
        <section class="features" style="background: rgba(0,0,0,0.1); padding: 80px 0;">
            <div class="container">
                <div class="section-title">
                    <h2>SBHS Islamic Society</h2>
                </div>
                <div style="text-align: center; max-width: 800px; margin: 0 auto;">
                    <p style="font-size: 1.2rem; margin-bottom: 30px;">
                        The Sydney Boys High School Islamic Society aims to provide a supportive environment for Muslim students to practice their faith, learn about Islam, and build a strong community within the school.
                    </p>
                    <div style="display: flex; justify-content: center; gap: 20px; flex-wrap: wrap;">
                        <div style="background: rgba(255,255,255,0.05); padding: 20px; border-radius: 15px; width: 200px; border: 1px solid rgba(255,204,0,0.1);">
                            <div style="font-size: 2.5rem; color: var(--sbhs-gold); margin-bottom: 15px;">
                                <i class="fas fa-calendar"></i>
                            </div>
                            <h3>Prayer Times</h3>
                            <p>Daily prayer schedules</p>
                        </div>
                        <div style="background: rgba(255,255,255,0.05); padding: 20px; border-radius: 15px; width: 200px; border: 1px solid rgba(255,204,0,0.1);">
                            <div style="font-size: 2.5rem; color: var(--sbhs-gold); margin-bottom: 15px;">
                                <i class="fas fa-users"></i>
                            </div>
                            <h3>Community</h3>
                            <p>Join our student group</p>
                        </div>
                        <div style="background: rgba(255,255,255,0.05); padding: 20px; border-radius: 15px; width: 200px; border: 1px solid rgba(255,204,0,0.1);">
                            <div style="font-size: 2.5rem; color: var(--sbhs-gold); margin-bottom: 15px;">
                                <i class="fas fa-book"></i>
                            </div>
                            <h3>Resources</h3>
                            <p>Study materials & guides</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Quran Audio Player Page -->
    <section class="quran-audio-page" id="quran-audio-page">
        <div class="container">
            <a href="#" class="back-button" id="back-button-audio">
                <i class="fas fa-arrow-left"></i> Back to Home
            </a>
            
            <div class="section-title">
                <h2>Quran Audio Player</h2>
                <p>Listen to beautiful recitations of the Holy Quran</p>
            </div>
            
            <div class="quran-player">
                <div class="quran-player-header">
                    <div class="card-icon">
                        <i class="fas fa-volume-up floating"></i>
                    </div>
                    <h2>Quran Recitations</h2>
                </div>
                
                <div class="quran-player-controls">
                    <div class="quran-player-row">
                        <span class="quran-player-label">Surah</span>
                        <select class="quran-player-select" id="surahSelect">
                            <option value="1">1. Al-Fatihah (The Opening)</option>
                            <option value="2">2. Al-Baqarah (The Cow)</option>
                            <option value="3">3. Ali 'Imran (Family of Imran)</option>
                            <option value="4">4. An-Nisa (The Women)</option>
                            <option value="5">5. Al-Ma'idah (The Table Spread)</option>
                        </select>
                    </div>
                    
                    <div class="quran-player-row">
                        <span class="quran-player-label">Reciter</span>
                        <select class="quran-player-select" id="reciterSelect">
                            <option value="ar.alafasy">Mishary Rashid Alafasy</option>
                            <option value="ar.abdulbasit">Abdul Basit Abdul Samad</option>
                            <option value="ar.maher">Maher Al Muaiqly</option>
                            <option value="ar.hudhaify">Ali Al Hudhaify</option>
                            <option value="ar.shatri">Saad Al Ghamdi</option>
                        </select>
                    </div>
                    
                    <div class="quran-player-row">
                        <span class="quran-player-label">Play</span>
                        <audio class="quran-player-audio" id="quranAudio" controls></audio>
                    </div>
                    
                    <div class="quran-player-ayahs" id="ayahsContainer">
                        <!-- Ayahs will be loaded here -->
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Quran Book Page -->
    <section class="quran-book-page" id="quran-book-page">
        <div class="container">
            <a href="#" class="back-button" id="back-button-quran">
                <i class="fas fa-arrow-left"></i> Back to Home
            </a>
            
            <div class="wrap">
                <aside class="panel">
                    <h1>3D Qur'an Book — Live</h1>
                    <div class="controls">
                        <label for="surahSelectBook">Choose Surah</label>
                        <select id="surahSelectBook"><option>Loading...</option></select>

                        <label for="mode">Show</label>
                        <select id="mode"><option value="both">Arabic + English</option><option value="ar">Arabic only</option><option value="en">English only</option></select>

                        <div class="controls-row">
                            <button id="prevBtn">⟨⟨ Prev</button>
                            <button id="nextBtn">Next ⟩⟩</button>
                        </div>

                        <div class="controls-row">
                            <button id="prevSurah">Prev Surah</button>
                            <button id="nextSurah">Next Surah</button>
                        </div>

                        <div style="display:flex;gap:8px;align-items:center">
                            <span class="pill" id="pageIndicator">—</span>
                            <span class="pill" id="ayahIndicator">—</span>
                        </div>

                        <div class="footer">Text via <strong>Al Quran Cloud</strong>. Pagination & page-curl are client-side.</div>
                    </div>
                </aside>

                <main id="stage" class="panel">
                    <div class="book-wrap" id="bookWrap">
                        <div class="book" id="book">
                            <div class="page" id="leftPage"><div class="hdr"></div><div class="content"></div></div>
                            <div class="page" id="rightPage"><div class="hdr"></div><div class="content"></div></div>
                        </div>
                        <div class="flip-curl" id="flipCurl" style="display:none"><div class="inner" id="flipInner"><div class="curl-shadow"></div></div></div>
                    </div>
                </main>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>SBHS Islam</h3>
                    <p>Providing Islamic resources to nurture faith, knowledge, and spiritual growth for Sydney Boys High School students.</p>
                    <div class="social-links">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
                
                <div class="footer-column">
                    <h3>Quick Links</h3>
                    <ul class="footer-links">
                        <li><a href="#" class="nav-home"><i class="fas fa-arrow-right"></i> Home</a></li>
                        <li><a href="#" class="nav-quran"><i class="fas fa-arrow-right"></i> Quran</a></li>
                        <li><a href="#" class="nav-audio"><i class="fas fa-arrow-right"></i> Audio Recitations</a></li>
                        <li><a href="#" class="nav-advice"><i class="fas fa-arrow-right"></i> Islamic Advice</a></li>
                        <li><a href="#" class="nav-about"><i class="fas fa-arrow-right"></i> About Us</a></li>
                    </ul>
                </div>
                
                <div class="footer-column">
                    <h3>Resources</h3>
                    <ul class="footer-links">
                        <li><a href="#"><i class="fas fa-arrow-right"></i> Prayer Times</a></li>
                        <li><a href="#"><i class="fas fa-arrow-right"></i> Islamic Calendar</a></li>
                        <li><a href="#"><i class="fas fa-arrow-right"></i> Hadith Collection</a></li>
                        <li><a href="#"><i class="fas fa-arrow-right"></i> Student Resources</a></li>
                        <li><a href="#"><i class="fas fa-arrow-right"></i> Events</a></li>
                    </ul>
                </div>
                
                <div class="footer-column">
                    <h3>Contact Us</h3>
                    <p><i class="fas fa-map-marker-alt"></i> Sydney Boys High School</p>
                    <p>Moore Park, NSW 2021</p>
                    <p><i class="fas fa-phone"></i> (02) 9361 6910</p>
                    <p><i class="fas fa-envelope"></i> islamicsociety@sbhs.nsw.edu.au</p>
                </div>
            </div>
            
            <div class="copyright">
                <p>&copy; 2023 SBHS Islamic Society. All rights reserved. Proudly part of Sydney Boys High School.</p>
            </div>
        </div>
    </footer>

    <script>
        // Header scroll effect
        window.addEventListener('scroll', function() {
            const header = document.querySelector('header');
            if (window.scrollY > 50) {
                header.classList.add('scrolled');
            } else {
                header.classList.remove('scrolled');
            }
        });
        
        // Audio player functionality
        const playBtn = document.getElementById('play-btn');
        const playIcon = document.getElementById('play-icon');
        const progressBar = document.getElementById('progress-bar');
        const reciterSelect = document.getElementById('reciter-select');
        const currentReciter = document.getElementById('current-reciter');
        
        let isPlaying = false;
        let progress = 0;
        let progressInterval;
        
        if (playBtn) {
            playBtn.addEventListener('click', function() {
                if (isPlaying) {
                    playIcon.classList.remove('fa-pause');
                    playIcon.classList.add('fa-play');
                    clearInterval(progressInterval);
                } else {
                    playIcon.classList.remove('fa-play');
                    playIcon.classList.add('fa-pause');
                    // Simulate audio progress
                    progressInterval = setInterval(() => {
                        progress += 0.5;
                        if (progress > 100) progress = 0;
                        progressBar.style.width = progress + '%';
                    }, 500);
                }
                isPlaying = !isPlaying;
            });
        }
        
        if (reciterSelect) {
            reciterSelect.addEventListener('change', function() {
                currentReciter.textContent = 'Reciter: ' + reciterSelect.options[reciterSelect.selectedIndex].text;
                if (isPlaying) {
                    playIcon.classList.remove('fa-pause');
                    playIcon.classList.add('fa-play');
                    clearInterval(progressInterval);
                    isPlaying = false;
                    progress = 0;
                    progressBar.style.width = progress + '%';
                }
            });
        }
        
        if (document.querySelector('.progress-container')) {
            document.querySelector('.progress-container').addEventListener('click', function(e) {
                const width = this.clientWidth;
                const clickX = e.offsetX;
                progress = (clickX / width) * 100;
                progressBar.style.width = progress + '%';
            });
        }
        
        // Islamic advice rotation
        const adviceText = document.getElementById('advice-text');
        const adviceAuthor = document.getElementById('advice-author');
        
        const adviceList = [
            {
                text: "Allah does not burden a soul beyond that it can bear.",
                author: "Quran 2:286"
            },
            {
                text: "Speak good or remain silent.",
                author: "Prophet Muhammad (PBUH)"
            },
            {
                text: "The strongest among you is the one who controls his anger.",
                author: "Prophet Muhammad (PBUH)"
            },
            {
                text: "Verily, with hardship comes ease.",
                author: "Quran 94:6"
            },
            {
                text: "Seek knowledge from the cradle to the grave.",
                author: "Prophet Muhammad (PBUH)"
            },
            {
                text: "The best charity is that given when one is in need.",
                author: "Prophet Muhammad (PBUH)"
            }
        ];
        
        let currentAdvice = 0;
        
        function rotateAdvice() {
            // Fade out
            adviceText.style.opacity = 0;
            adviceAuthor.style.opacity = 0;
            
            setTimeout(() => {
                currentAdvice = (currentAdvice + 1) % adviceList.length;
                adviceText.textContent = adviceList[currentAdvice].text;
                adviceAuthor.textContent = "- " + adviceList[currentAdvice].author;
                
                // Fade in
                adviceText.style.opacity = 1;
                adviceAuthor.style.opacity = 1;
            }, 500);
        }
        
        // Rotate advice every 8 seconds
        setInterval(rotateAdvice, 8000);
        
        // Animate feature cards when they come into view
        const observerOptions = {
            root: null,
            rootMargin: '0px',
            threshold: 0.1
        };
        
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.opacity = 1;
                    entry.target.style.transform = 'translateY(0)';
                }
            });
        }, observerOptions);
        
        document.querySelectorAll('.feature-card').forEach(card => {
            card.style.opacity = 0;
            observer.observe(card);
        });
        
        // Navigation between pages
        const mainContent = document.querySelector('.main-content');
        const quranAudioPage = document.getElementById('quran-audio-page');
        const quranBookPage = document.getElementById('quran-book-page');
        const backButtonAudio = document.getElementById('back-button-audio');
        const backButtonQuran = document.getElementById('back-button-quran');
        
        // Navigation to home
        document.querySelectorAll('.nav-home').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                mainContent.style.display = 'block';
                quranAudioPage.style.display = 'none';
                quranBookPage.style.display = 'none';
                document.body.style.background = 'var(--page-bg)';
                window.scrollTo(0, 0);
            });
        });
        
        // Navigation to Quran book
        document.querySelectorAll('.nav-quran').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                mainContent.style.display = 'none';
                quranAudioPage.style.display = 'none';
                quranBookPage.style.display = 'block';
                document.body.style.background = 'linear-gradient(180deg, #07102b, #0b1020)';
                window.scrollTo(0, 0);
            });
        });
        
        // Navigation to audio page
        document.querySelectorAll('.nav-audio').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                mainContent.style.display = 'none';
                quranAudioPage.style.display = 'block';
                quranBookPage.style.display = 'none';
                document.body.style.background = 'linear-gradient(180deg, #070b18, #0b1020 30%, #0b1020 70%, #0a0f22)';
                window.scrollTo(0, 0);
                loadSurah(1);
            });
        });
        
        // Back to home from audio page
        if (backButtonAudio) {
            backButtonAudio.addEventListener('click', function(e) {
                e.preventDefault();
                mainContent.style.display = 'block';
                quranAudioPage.style.display = 'none';
                quranBookPage.style.display = 'none';
                document.body.style.background = 'var(--page-bg)';
                window.scrollTo(0, 0);
            });
        }
        
        // Back to home from Quran book page
        if (backButtonQuran) {
            backButtonQuran.addEventListener('click', function(e) {
                e.preventDefault();
                mainContent.style.display = 'block';
                quranAudioPage.style.display = 'none';
                quranBookPage.style.display = 'none';
                document.body.style.background = 'var(--page-bg)';
                window.scrollTo(0, 0);
            });
        }
        
        // Quran Audio Player Functionality
        const surahSelect = document.getElementById('surahSelect');
        const reciterSelectQuran = document.getElementById('reciterSelect');
        const quranAudio = document.getElementById('quranAudio');
        const ayahsContainer = document.getElementById('ayahsContainer');
        
        // Load Surah
        async function loadSurah(surahNumber) {
            // Show loading state
            ayahsContainer.innerHTML = '<p style="text-align: center; padding: 20px;">Loading Surah...</p>';
            
            try {
                // Simulate API call
                await new Promise(resolve => setTimeout(resolve, 800));
                
                // Sample data for demonstration
                const ayahs = [
                    {
                        number: 1,
                        text: "بِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ",
                        translation: "In the name of Allah, the Most Gracious, the Most Merciful."
                    },
                    {
                        number: 2,
                        text: "الْحَمْدُ لِلَّهِ رَبِّ الْعَالَمِينَ",
                        translation: "All praise is due to Allah, Lord of all the worlds."
                    },
                    {
                        number: 3,
                        text: "الرَّحْمَٰنِ الرَّحِيمِ",
                        translation: "The Most Gracious, the Most Merciful."
                    },
                    {
                        number: 4,
                        text: "مَالِكِ يَوْمِ الدِّينِ",
                        translation: "Master of the Day of Judgment."
                    },
                    {
                        number: 5,
                        text: "إِيَّاكَ نَعْبُدُ وَإِيَّاكَ نَسْتَعِينُ",
                        translation: "You alone we worship, and You alone we ask for help."
                    },
                    {
                        number: 6,
                        text: "اهْدِنَا الصِّرَاطَ الْمُسْتَقِيمَ",
                        translation: "Guide us to the straight path."
                    },
                    {
                        number: 7,
                        text: "صِرَاطَ الَّذِينَ أَنْعَمْتَ عَلَيْهِمْ غَيْرِ الْمَغْضُوبِ عَلَيْهِمْ وَلَا الضَّالِّينَ",
                        translation: "The path of those upon whom You have bestowed favor, not of those who have evoked [Your] anger or of those who are astray."
                    }
                ];
                
                // Update audio source
                const reciter = reciterSelectQuran.value;
                quranAudio.src = `https://cdn.islamic.network/quran/audio-surah/128/${reciter}/${surahNumber}.mp3`;
                
                // Render ayahs
                ayahsContainer.innerHTML = '';
                ayahs.forEach(ayah => {
                    const ayahElement = document.createElement('div');
                    ayahElement.className = 'quran-player-ayah';
                    ayahElement.innerHTML = `
                        <div class="quran-player-arabic">${ayah.text}</div>
                        <div class="quran-player-english">${ayah.number}. ${ayah.translation}</div>
                    `;
                    ayahsContainer.appendChild(ayahElement);
                });
                
            } catch (error) {
                console.error('Error loading surah:', error);
                ayahsContainer.innerHTML = '<p style="text-align: center; padding: 20px; color: #ff6b6b;">Error loading surah. Please try again later.</p>';
            }
        }
        
        // Surah selection change
        if (surahSelect) {
            surahSelect.addEventListener('change', function() {
                const surahNumber = this.value;
                loadSurah(surahNumber);
            });
        }
        
        // Reciter selection change
        if (reciterSelectQuran) {
            reciterSelectQuran.addEventListener('change', function() {
                const surahNumber = surahSelect.value;
                loadSurah(surahNumber);
            });
        }
        
        // Initialize Quran audio page
        if (surahSelect && reciterSelectQuran) {
            loadSurah(1);
        }
        
        // Quran Book Functionality
        const API = 'https://api.alquran.cloud/v1';
        const els = {
            surahSelect: document.getElementById('surahSelectBook'),
            mode: document.getElementById('mode'),
            prevBtn: document.getElementById('prevBtn'),
            nextBtn: document.getElementById('nextBtn'),
            prevSurah: document.getElementById('prevSurah'),
            nextSurah: document.getElementById('nextSurah'),
            pageIndicator: document.getElementById('pageIndicator'),
            ayahIndicator: document.getElementById('ayahIndicator'),
            leftPage: document.getElementById('leftPage'),
            rightPage: document.getElementById('rightPage'),
            flipCurl: document.getElementById('flipCurl'),
            flipInner: document.getElementById('flipInner')
        };

        let state = {
            surahs: [], // metadata list
            currentSurah: 1,
            ayahs: [], // {global,inSurah,ar,en}
            pages: [], // array of pages; each page is array of ayah indices
            pageIndex: 0,
            mode: 'both'
        };

        function setIndicator(){
            const totalPages = state.pages.length || 0;
            const cur = totalPages ? (state.pageIndex + 1) : 0;
            els.pageIndicator.textContent = `Page ${cur}/${totalPages}`;
            const curAyahs = state.pages[state.pageIndex] || [];
            if(curAyahs.length) els.ayahIndicator.textContent = `Ayah ${curAyahs[0]}–${curAyahs[curAyahs.length-1]}`; else els.ayahIndicator.textContent = '—';
        }

        // Fetch surah list
        async function fetchSurahList(){
            try{
                const r = await fetch(`${API}/surah`);
                const j = await r.json();
                state.surahs = j.data || [];
                els.surahSelect.innerHTML = '';
                state.surahs.forEach(s => {
                    const opt = document.createElement('option'); opt.value = s.number; opt.textContent = `${s.number}. ${s.englishName} — ${s.name}`; els.surahSelect.appendChild(opt);
                });
                els.surahSelect.value = '1';
                loadSurahBook(1);
            }catch(e){
                console.error(e); els.surahSelect.innerHTML = '<option>Could not load</option>';
            }
        }

        // Load surah content (Arabic + English)
        async function loadSurahBook(n){
            try{
                state.currentSurah = n; state.ayahs = []; state.pages = []; state.pageIndex = 0;
                // Request Arabic + Saheeh International
                const res = await fetch(`${API}/surah/${n}/editions/quran-uthmani,en.sahih`);
                const json = await res.json();
                if(!json || !json.data) throw new Error('bad data');
                const ar = json.data.find(d=>d.edition.identifier==='quran-uthmani');
                const en = json.data.find(d=>d.edition.identifier==='en.sahih' || d.edition.identifier==='en.asad');
                const arAy = ar.ayahs || [];
                const enAy = (en && en.ayahs) ? en.ayahs : [];
                state.ayahs = arAy.map((a,i)=>({global:a.number,inSurah:a.numberInSurah,ar:a.text,en: enAy[i] ? enAy[i].text : ''}));
                paginate();
                renderSpread();
            }catch(e){ console.error(e); alert('Failed to load surah. Try again.'); }
        }

        // Simple pagination algorithm
        function paginate(){
            const canvasW = 720; // internal layout width for estimation
            const pagePad = 60; // px
            const arSize = 36; const enSize = 18; // px
            const approxLineHeight = (state.mode==='ar'? arSize*1.2 : state.mode==='en'? enSize*1.4 : (arSize*1.1 + enSize*1.0));
            const pageH = 720 - pagePad*2; // approximate available height
            const linesPerPage = Math.floor(pageH / approxLineHeight);

            // estimate lines per ayah by text length
            function estimateLines(text, size){
                if(!text) return 0;
                const charsPerLine = Math.floor((canvasW - pagePad*2) / (size*0.5));
                return Math.max(1, Math.ceil(text.length / charsPerLine));
            }

            const pages = [];
            let cur = []; let curLines = 0;
            for(const v of state.ayahs){
                let lines = 0;
                if(state.mode !== 'en') lines += estimateLines(v.ar, arSize);
                if(state.mode !== 'ar') lines += estimateLines(v.en || '', enSize);
                lines = Math.max(1, lines);
                if(curLines + lines > linesPerPage){ pages.push(cur); cur = []; curLines = 0; }
                cur.push(v.inSurah); curLines += lines;
            }
            if(cur.length) pages.push(cur);
            // ensure even pages for spread
            if(pages.length % 2 !== 0) pages.push([]);
            state.pages = pages; state.pageIndex = 0; setIndicator();
        }

        // Render a page into DOM
        function renderPageElement(pageIdx, domElement){
            const indices = state.pages[pageIdx] || [];
            if(indices.length === 0){ domElement.innerHTML = '<div class="empty">—</div>'; return; }
            const start = indices[0]; const end = indices[indices.length-1];
            const header = `<div class="hdr"><div><strong>Surah ${state.currentSurah}</strong></div><div class="muted">Ayahs ${start}–${end}</div></div>`;
            let body = '';
            for(const n of indices){
                const v = state.ayahs.find(a=>a.inSurah === n);
                if(!v) continue;
                if(state.mode !== 'en') body += `<div class="arab">${v.ar} <span style="font-size:15px;color:#54627f">(${v.inSurah})</span></div>`;
                if(state.mode !== 'ar') body += `<div class="eng">${v.en}</div>`;
            }
            domElement.innerHTML = header + '<div class="content">' + body + '</div>';
        }

        function renderSpread(){
            renderPageElement(state.pageIndex, els.leftPage);
            renderPageElement(state.pageIndex+1, els.rightPage);
            setIndicator();
        }

        // Curl animation (visual only)
        function animateCurl(direction = 'next'){
            // direction: 'next' or 'prev'
            if(els.flipCurl.style.display !== 'none') return; // busy
            const curl = els.flipCurl; const inner = els.flipInner;
            // snapshot current right or left page content
            const source = (direction==='next') ? els.rightPage.innerHTML : els.leftPage.innerHTML;
            inner.innerHTML = `<div style="padding:34px">${source}</div>`;
            curl.style.display = 'block';
            curl.style.left = '50%';
            curl.style.transformOrigin = 'left center';
            curl.animate([
                { transform: 'translateX(0) rotateY(0deg) translateZ(0)' },
                { transform: 'translateX(-8%) rotateY(-58deg) translateZ(50px) skewX(-6deg)' }
            ], { duration: 520, easing: 'cubic-bezier(.2,.9,.2,1)' });
            setTimeout(()=>{ curl.style.display='none'; }, 540);
        }

        // Navigation handlers
        function nextPage(){ if(state.pageIndex+2 >= state.pages.length) return; animateCurl('next'); setTimeout(()=>{ state.pageIndex += 2; renderSpread(); }, 260); }
        function prevPage(){ if(state.pageIndex-2 < 0) return; animateCurl('prev'); setTimeout(()=>{ state.pageIndex -= 2; renderSpread(); }, 260); }

        function nextSurah(){ const cur = state.currentSurah; if(cur < state.surahs.length) { loadSurahBook(cur+1); els.surahSelect.value = String(cur+1); } }
        function prevSurah(){ const cur = state.currentSurah; if(cur > 1) { loadSurahBook(cur-1); els.surahSelect.value = String(cur-1); } }

        // Wire up UI
        els.nextBtn.addEventListener('click', nextPage);
        els.prevBtn.addEventListener('click', prevPage);
        els.nextSurah.addEventListener('click', nextSurah);
        els.prevSurah.addEventListener('click', prevSurah);
        els.surahSelect.addEventListener('change', (e)=> loadSurahBook(Number(e.target.value)));
        els.mode.addEventListener('change', (e)=> { state.mode = e.target.value; paginate(); renderSpread(); });
        window.addEventListener('keydown', (e)=>{ if(e.key==='ArrowRight') nextPage(); if(e.key==='ArrowLeft') prevPage(); if(e.key==='PageDown') nextSurah(); if(e.key==='PageUp') prevSurah(); });

        // Initialize Quran Book
        fetchSurahList();
    </script>
</body>
</html>
